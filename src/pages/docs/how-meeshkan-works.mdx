import { Box, Text } from "@chakra-ui/core"

# How Meeshkan works

Testing is the core of what Meeshkan does and it's important that we're transparent about how it all works. This section covers some of the Meeshkan fundamentals.

**In this section:**

- [Running the tests](#running-the-tests)
- [Testing frequency](#testing-frequency)
- [Reporting bugs and issues](#reporting-bugs-and-issues)
- [Project configuration](#project-configuration)
- [Suggested fixes](#suggested-fixes)

## Running the tests

Meeshkan uses an [OpenAPI specification](https://swagger.io/specification/) to understand your project's expected inputs and outputs. This OpenAPI specification provides a framework for Meeshkan to generate test properties. From there, Meeshkan runs [property-based tests](/docs/faq/#what-is-property-based-testing) on your project.

If you don't already have an OpenAPI specification, we can generate one for you with our [HTTP Mocking Toolkit (HMT)](https://github.com/meeshkan/hmt). HMT collects recordings of server traffic and generates a [JSON Lines](http://jsonlines.org/) file based on the logs. It then builds an OpenAPI schema from that file.

## Testing frequency

During the alpha release (which we're in now), there are two test schedules:

1. **Your project is out of the box compatible.** Using the checks API, Meeshkan will automatically run on every commit where the app is installed.
1. **Your project needs some manually configuration by the Meeshkan team to build and run.** Meeshkan will test all registered repositories on a weekly basis. We decided on weekly because property-based testing is very resource-intensive. Not to mention that the volume of bugs discovered in a single run can be significant.

We'll soon be introducing paid plans with options to test repositories more often. If you're interested in this, [let us know](/contact/).

## Reporting bugs and issues

We're currently experimenting with the most effective way to report bugs. By default, checks happen on a per commit basis using the GitHub Checks API.

![Branch checks on GitHub](https://media.graphcms.com/LN6VPBZQGWwERj6RjeZw)

Other options we're exploring include email digests, Slack notifications, and filing an issue on the registered repository.

## Project configuration

Each project has configuration settings that will allow Meeshkan tests to run automatically. If you'd like tests to run on every commit, please enter your build settings!

![Configuration UI](https://media.graphcms.com/FdmqxNNqT5iWaT31FXEA)

You can find your project's configuration at `https://app.meeshkan.com/{yourTeam}/{yourProject}/configuration`.

### Build settings

Please add credentials for your local server, and not your live endpoints. Testing against production credentials can cause permanent data damage.
- **Root directory**: The path to your app in your repository. For instance, if your app lives in the home directory, then you would use `./` as your root directory. 
- **Build command**: The command(s) your app framework provides for compiling your code. `npm install && npm start` is an example build command for a repository that uses NPM and provides a "start" script.
- **OpenAPI location**: The path or endpoint to your repository's *OpenAPI specification* (such as `http://localhost:8000/api/openapi`).
- **GraphQL endpoint**: The path or endpoint to your repository's *GraphQL schema* (such as `http://localhost:8000/api/graphql`).

### Slack integration

Our slack app allows you to recieve notifications in the channel of your choosing. Currently notifications are global for any bugs found. In the future we will expose granular controls to allow you to only recieve notifications for high priority bugs.

## Suggested fixes

In some cases, Meeshkan is able to suggest a fix for the reported bug. This is a sparse feature at the moment, but it's being actively developed. Please note that, in any case, these are _suggestions_ and not a certain solution to the problem.

Here's an example of what they could look like (anonymized for privacy). The suggestion is the last sentence of the issue description:

![A screenshot of an example issue filed by the Meeshkan GitHub bot. At the very bottom it says, 'To resolve this issue, we recommend URL encoding all paths and queries before making HTTP calls'.](https://user-images.githubusercontent.com/26869552/81233095-5fc9aa00-8ff6-11ea-9ba4-22405ae5666d.png)

<Box mt={10}>
  <Text as="i">Last updated: 25th May 2020</Text>
</Box>
